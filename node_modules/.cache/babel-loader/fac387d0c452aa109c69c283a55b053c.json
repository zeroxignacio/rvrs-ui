{"ast":null,"code":"import _regeneratorRuntime from\"/Users/ignacio/Documents/GitHub/reverse-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/ignacio/Documents/GitHub/reverse-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/ignacio/Documents/GitHub/reverse-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"/Users/ignacio/Documents/GitHub/reverse-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";var _templateObject,_templateObject2,_templateObject3;import React,{useMemo,useState,useCallback}from'react';import BigNumber from'bignumber.js';import styled from'styled-components';import{getContract}from'utils/erc20';import{Flex,LinkExternal}from'@pancakeswap-libs/uikit';import{useFarmFromPid,useFarmTokensToUsd,useFarmUser}from'state/hooks';import useI18n from'hooks/useI18n';import UnlockButton from'components/UnlockButton';import{useApprove}from'hooks/useApprove';import labo from'config/constants/labo';import StakeAction from'./StakeAction';import HarvestAction from'./HarvestAction';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Action=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  padding-top: 16px;\\n\"])));var StyledLinkExternal=styled(LinkExternal)(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  text-decoration: none;\\n  font-weight: bold;\\n  color: \",\";\\n  display: flex;\\n  align-items: center;\\n  margin-top: 25px;\\n\\n  svg {\\n    padding-left: 4px;\\n    height: 18px;\\n    width: auto;\\n    fill: \",\";\\n  }\\n\"])),function(_ref){var theme=_ref.theme;return theme.colors.text;},function(_ref2){var theme=_ref2.theme;return theme.colors.primary;});var StyledBtn=styled.button(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n  -webkit-box-align: center;\\n  align-items: center;\\n  background-color: rgba(0, 0, 0,0) !important;\\n  border: 1px;\\n  border-style: solid !important;\\n  border-color: #ffff !important;\\n  border-radius: 10px;\\n  color: #ffff;\\n  font-size: 15px;\\n  font-weight: 400;\\n  width: 100%;\\n  display: inline-flex;\\n  min-height: 18px;\\n  max-height: 30px;\\n  max-width: 90px;\\n  padding: 20px;\\n\\n  \"])));var CardActions=function CardActions(_ref3){var farm=_ref3.farm,ethereum=_ref3.ethereum,account=_ref3.account;var TranslateString=useI18n();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),requestedApproval=_useState2[0],setRequestedApproval=_useState2[1];var _useFarmFromPid=useFarmFromPid(farm.pid),pid=_useFarmFromPid.pid,lpAddresses=_useFarmFromPid.lpAddresses,tokenAddresses=_useFarmFromPid.tokenAddresses,isTokenOnly=_useFarmFromPid.isTokenOnly,depositFeeBP=_useFarmFromPid.depositFeeBP;var _useFarmUser=useFarmUser(pid),allowance=_useFarmUser.allowance,tokenBalance=_useFarmUser.tokenBalance,stakedBalance=_useFarmUser.stakedBalance,earnings=_useFarmUser.earnings;var lpAddress=lpAddresses[process.env.REACT_APP_CHAIN_ID];var tokenAddress=tokenAddresses[process.env.REACT_APP_CHAIN_ID];var lpName=farm.lpSymbol.toUpperCase();var isApproved=account&&allowance&&allowance.isGreaterThan(0);var tokenBalanceUsd=useFarmTokensToUsd(pid,tokenBalance);var stakedBalanceUsd=useFarmTokensToUsd(pid,stakedBalance.div(new BigNumber(10).pow(18)));// console.log(\"StakedBalance\", farm.pid, stakedBalance && stakedBalance.toNumber())\n// console.log(\"StakedBalanceUsd\", farm.pid, stakedBalanceUsd && stakedBalanceUsd.toNumber())\n// console.log(pid)\n// console.log(tokenBalanceUsd)\n// console.log(stakedBalanceUsd)\nvar lpContract=useMemo(function(){if(isTokenOnly){return getContract(ethereum,tokenAddress);}return getContract(ethereum,lpAddress);},[ethereum,lpAddress,tokenAddress,isTokenOnly]);var _useApprove=useApprove(lpContract),onApprove=_useApprove.onApprove;var handleApprove=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;setRequestedApproval(true);_context.next=4;return onApprove();case 4:setRequestedApproval(false);_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);console.error(_context.t0);case 10:case\"end\":return _context.stop();}}},_callee,null,[[0,7]]);})),[onApprove]);var renderApprovalOrStakeButton=function renderApprovalOrStakeButton(){return isApproved?/*#__PURE__*/_jsx(StakeAction,{stakedBalance:stakedBalance,stakedBalanceUsd:stakedBalanceUsd,tokenBalance:tokenBalance,tokenBalanceUsd:tokenBalanceUsd,tokenName:lpName,pid:pid,depositFeeBP:depositFeeBP}):/*#__PURE__*/_jsx(\"span\",{\"data-tip\":true,\"data-for\":\"happyFace\",children:/*#__PURE__*/_jsx(Flex,{justifyContent:\"end\",children:/*#__PURE__*/_jsx(StyledBtn,{disabled:requestedApproval||labo.isLocked.unlockWalletButton,onClick:handleApprove,children:TranslateString(999,'Enable')})})});};return/*#__PURE__*/_jsxs(Action,{children:[/*#__PURE__*/_jsx(HarvestAction,{earnings:earnings,pid:pid}),!account?/*#__PURE__*/_jsx(UnlockButton,{justifyContent:\"end\",style:{border:'1px',justifyContent:\"center\",color:'#8299dd !important',borderRadius:'10px',fontSize:'15px',fontWeight:'200',width:'35%',display:'inline-flex',height:'44px',padding:'20px',minHeight:'21px',maxHeight:'33px',marginTop:'12px'}}):renderApprovalOrStakeButton()]});};export default CardActions;","map":{"version":3,"sources":["/Users/ignacio/Documents/GitHub/reverse-frontend/src/views/Farms/components/FarmCard/CardActionsContainer.tsx"],"names":["React","useMemo","useState","useCallback","BigNumber","styled","getContract","Flex","LinkExternal","useFarmFromPid","useFarmTokensToUsd","useFarmUser","useI18n","UnlockButton","useApprove","labo","StakeAction","HarvestAction","Action","div","StyledLinkExternal","theme","colors","text","primary","StyledBtn","button","CardActions","farm","ethereum","account","TranslateString","requestedApproval","setRequestedApproval","pid","lpAddresses","tokenAddresses","isTokenOnly","depositFeeBP","allowance","tokenBalance","stakedBalance","earnings","lpAddress","process","env","REACT_APP_CHAIN_ID","tokenAddress","lpName","lpSymbol","toUpperCase","isApproved","isGreaterThan","tokenBalanceUsd","stakedBalanceUsd","pow","lpContract","onApprove","handleApprove","console","error","renderApprovalOrStakeButton","isLocked","unlockWalletButton","border","justifyContent","color","borderRadius","fontSize","fontWeight","width","display","height","padding","minHeight","maxHeight","marginTop"],"mappings":"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","sourcesContent":["import React, { useMemo, useState, useCallback } from 'react'\nimport BigNumber from 'bignumber.js'\nimport styled from 'styled-components'\nimport { provider } from 'web3-core'\nimport { getContract } from 'utils/erc20'\nimport { Button, Flex, LinkExternal, Text } from '@pancakeswap-libs/uikit'\nimport { Farm } from 'state/types'\nimport {useFarmFromPid, useFarmFromSymbol, useFarmTokensToUsd, useFarmUser, usePriceCakeBusd} from 'state/hooks'\nimport useI18n from 'hooks/useI18n'\nimport UnlockButton from 'components/UnlockButton'\nimport { useApprove } from 'hooks/useApprove'\nimport ReactTooltip from 'react-tooltip';\nimport labo from 'config/constants/labo'\nimport { Address } from 'config/constants/types'\nimport StakeAction from './StakeAction'\nimport HarvestAction from './HarvestAction'\n\nconst Action = styled.div`\n  padding-top: 16px;\n`\nexport interface FarmWithStakedValue extends Farm {\n  apy?: BigNumber\n}\n\ninterface FarmCardActionsProps {\n  farm: FarmWithStakedValue\n  ethereum?: provider\n  account?: string\n}\nconst StyledLinkExternal = styled(LinkExternal)`\n  text-decoration: none;\n  font-weight: bold;\n  color: ${({ theme }) => theme.colors.text};\n  display: flex;\n  align-items: center;\n  margin-top: 25px;\n\n  svg {\n    padding-left: 4px;\n    height: 18px;\n    width: auto;\n    fill: ${({ theme }) => theme.colors.primary};\n  }\n`\n\n\nconst StyledBtn = styled.button`\n  -webkit-box-align: center;\n  align-items: center;\n  background-color: rgba(0, 0, 0,0) !important;\n  border: 1px;\n  border-style: solid !important;\n  border-color: #ffff !important;\n  border-radius: 10px;\n  color: #ffff;\n  font-size: 15px;\n  font-weight: 400;\n  width: 100%;\n  display: inline-flex;\n  min-height: 18px;\n  max-height: 30px;\n  max-width: 90px;\n  padding: 20px;\n\n  `\n\nconst CardActions: React.FC<FarmCardActionsProps> = ({ farm, ethereum, account }) => {\n  const TranslateString = useI18n()\n  const [requestedApproval, setRequestedApproval] = useState(false)\n  const { pid, lpAddresses, tokenAddresses, isTokenOnly, depositFeeBP } = useFarmFromPid(farm.pid)\n  const { allowance, tokenBalance, stakedBalance, earnings } = useFarmUser(pid)\n  const lpAddress = lpAddresses[process.env.REACT_APP_CHAIN_ID]\n  const tokenAddress = tokenAddresses[process.env.REACT_APP_CHAIN_ID];\n  const lpName = farm.lpSymbol.toUpperCase()\n  const isApproved = account && allowance && allowance.isGreaterThan(0)\n  const tokenBalanceUsd = useFarmTokensToUsd(pid, tokenBalance)\n  const stakedBalanceUsd = useFarmTokensToUsd(pid, stakedBalance.div(new BigNumber(10).pow(18)))\n  // console.log(\"StakedBalance\", farm.pid, stakedBalance && stakedBalance.toNumber())\n  // console.log(\"StakedBalanceUsd\", farm.pid, stakedBalanceUsd && stakedBalanceUsd.toNumber())\n\n  // console.log(pid)\n  // console.log(tokenBalanceUsd)\n  // console.log(stakedBalanceUsd)\n\n  const lpContract = useMemo(() => {\n    if(isTokenOnly){\n      return getContract(ethereum as provider, tokenAddress);\n    }\n    return getContract(ethereum as provider, lpAddress);\n  }, [ethereum, lpAddress, tokenAddress, isTokenOnly])\n\n  const { onApprove } = useApprove(lpContract)\n\n  const handleApprove = useCallback(async () => {\n    try {\n      setRequestedApproval(true)\n      await onApprove()\n      setRequestedApproval(false)\n    } catch (e) {\n      console.error(e)\n    }\n  }, [onApprove])\n\n\n\n\n  const renderApprovalOrStakeButton = () => {\n    return isApproved ? (\n      <StakeAction\n          stakedBalance={stakedBalance}\n          stakedBalanceUsd={stakedBalanceUsd}\n          tokenBalance={tokenBalance}\n          tokenBalanceUsd={tokenBalanceUsd}\n          tokenName={lpName} pid={pid}\n          depositFeeBP={depositFeeBP}\n      />\n    ) : (\n      <span data-tip data-for='happyFace'>\n\n      <Flex justifyContent=\"end\">\n        <StyledBtn\n        disabled={requestedApproval || labo.isLocked.unlockWalletButton} \n        onClick={handleApprove}>\n          {TranslateString(999, 'Enable')}\n        </StyledBtn>\n        \n      </Flex>\n      </span>\n    )\n  }\n\n  return (\n    <Action  >\n\n      <HarvestAction earnings={earnings} pid={pid} />\n\n\n      {!account ? <UnlockButton justifyContent=\"end\"\n      style={{\n        border: '1px',\n        justifyContent: \"center\",\n        color: '#8299dd !important',\n        borderRadius: '10px',\n        fontSize: '15px',\n        fontWeight: '200',\n        width: '35%',\n        display: 'inline-flex',\n        height: '44px',\n        padding: '20px',\n        minHeight: '21px',\n        maxHeight: '33px',\n        marginTop: '12px',\n      }} \n/> : renderApprovalOrStakeButton()}\n\n    </Action>\n  )\n}\n\nexport default CardActions\n"]},"metadata":{},"sourceType":"module"}