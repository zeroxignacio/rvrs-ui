{"ast":null,"code":"import _regeneratorRuntime from\"/Users/ignacio/Documents/GitHub/reverse-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/ignacio/Documents/GitHub/reverse-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/ignacio/Documents/GitHub/reverse-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _objectSpread from\"/Users/ignacio/Documents/GitHub/reverse-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import React,{useState}from'react';import{Link,Route,useRouteMatch}from'react-router-dom';import BigNumber from'bignumber.js';import{useWallet}from'@binance-chain/bsc-use-wallet';import{BLOCKS_PER_YEAR}from'config';import Ripples from'react-ripples';import orderBy from'lodash/orderBy';import partition from'lodash/partition';import ActiveInactiveButton from'components/layout/buttons/activeInactiveButton';import ActiveInactiveContatiner from'components/layout/containers/activeInactiveContainer';import useBlock from'hooks/useBlock';import{usePools2,usePrices,getTotalValueFromQuoteTokens,lookupPrice}from'state/hooks';import{QuoteToken}from'config/constants/types';import Page from'components/layout/containers/page';import PoolCard from'./card';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Bond=function Bond(){var _useRouteMatch=useRouteMatch(),path=_useRouteMatch.path;var _useWallet=useWallet(),account=_useWallet.account;var pools2=usePools2(account);var prices=usePrices();var block=useBlock();var poolsWithApy=pools2.map(function(pool2){var quoteTokens=new BigNumber(pool2.quoteTokenPerLp).times(pool2.totalStaked).div(new BigNumber(10).pow(18));if(pool2.isSingleAsset){quoteTokens=new BigNumber(pool2.totalStaked).div(new BigNumber(10).pow(18)).div(2);}var tvl=getTotalValueFromQuoteTokens(quoteTokens,pool2.quoteTokenSymbol,prices);var rewardTokenPrice=lookupPrice(QuoteToken.RVRS,prices);var totalRewardPricePerYear=rewardTokenPrice.times(pool2.tokenPerBlock).times(BLOCKS_PER_YEAR);var apy=totalRewardPricePerYear.div(tvl).times(100);return _objectSpread(_objectSpread({},pool2),{},{isFinished:pool2.sousId===0?false:pool2.isFinished&&block>pool2.endBlock,apy:apy,tvl:tvl});// console.log(pool2.sousId, quoteTokens && quoteTokens.toNumber(), tvl && tvl.toNumber())\n// console.log(\"APY\", pool2, tvl && tvl.toNumber())\n// console.log(\"TVL\", pool2.stakingTokenName, tvl && tvl.toNumber(), apy && apy.toNumber())\n// const totalStakingTokenInPool = stakingTokenPriceInBNB.times(getBalanceNumber(pool2.totalStaked))\n// console.log(\"price\", pool2.tokenName, rewardTokenPrice && rewardTokenPrice.toNumber())\n});var _partition=partition(poolsWithApy,function(pool2){return pool2.isFinished;}),_partition2=_slicedToArray(_partition,2),finishedPools=_partition2[0],openPools=_partition2[1];var _useRouteMatch2=useRouteMatch(),url=_useRouteMatch2.url,isExact=_useRouteMatch2.isExact;var _useState=useState(true),_useState2=_slicedToArray(_useState,2),modalOpen=_useState2[0],setModalOpen=_useState2[1];var handleModal=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setModalOpen(!modalOpen);case 1:case\"end\":return _context.stop();}}},_callee);}));return function handleModal(){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(Page,{children:[/*#__PURE__*/_jsx(Route,{path:\"\".concat(path),children:orderBy(openPools,['sortOrder']).map(function(pool2){return/*#__PURE__*/_jsx(PoolCard,{pool2:pool2},pool2.sousId);})}),/*#__PURE__*/_jsx(Route,{path:\"\".concat(path,\"/inactive\"),children:orderBy(finishedPools,['sortOrder']).map(function(pool2){return/*#__PURE__*/_jsx(PoolCard,{pool2:pool2},pool2.sousId);})}),/*#__PURE__*/_jsxs(ActiveInactiveContatiner,{children:[/*#__PURE__*/_jsx(\"div\",{style:{display:'inline-flex',borderRadius:25,overflow:'hidden'},children:/*#__PURE__*/_jsx(Ripples,{children:/*#__PURE__*/_jsx(ActiveInactiveButton,{as:Link,className:\"nav-links\",to:\"\".concat(url),children:\"Active\"})})}),/*#__PURE__*/_jsx(\"div\",{style:{display:'inline-flex',borderRadius:15,overflow:'hidden'},children:/*#__PURE__*/_jsx(Ripples,{children:/*#__PURE__*/_jsx(ActiveInactiveButton,{as:Link,className:\"nav-links\",to:\"\".concat(url,\"/inactive\"),children:\"Inactive\"})})})]})]});};export default Bond;","map":{"version":3,"sources":["/Users/ignacio/Documents/GitHub/reverse-frontend/src/pages/Bonds/bonds.tsx"],"names":["React","useState","Link","Route","useRouteMatch","BigNumber","useWallet","BLOCKS_PER_YEAR","Ripples","orderBy","partition","ActiveInactiveButton","ActiveInactiveContatiner","useBlock","usePools2","usePrices","getTotalValueFromQuoteTokens","lookupPrice","QuoteToken","Page","PoolCard","Bond","path","account","pools2","prices","block","poolsWithApy","map","pool2","quoteTokens","quoteTokenPerLp","times","totalStaked","div","pow","isSingleAsset","tvl","quoteTokenSymbol","rewardTokenPrice","RVRS","totalRewardPricePerYear","tokenPerBlock","apy","isFinished","sousId","endBlock","finishedPools","openPools","url","isExact","modalOpen","setModalOpen","handleModal","display","borderRadius","overflow"],"mappings":"wpBAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,KAAgC,OAAhC,CACA,OAASC,IAAT,CAAeC,KAAf,CAAsBC,aAAtB,KAA2C,kBAA3C,CACA,MAAOC,CAAAA,SAAP,KAAsB,cAAtB,CACA,OAASC,SAAT,KAA0B,+BAA1B,CACA,OAASC,eAAT,KAAgC,QAAhC,CACA,MAAOC,CAAAA,OAAP,KAAuC,eAAvC,CACA,MAAOC,CAAAA,OAAP,KAAoB,gBAApB,CACA,MAAOC,CAAAA,SAAP,KAAsB,kBAAtB,CACA,MAAOC,CAAAA,oBAAP,KAAiC,gDAAjC,CACA,MAAOC,CAAAA,wBAAP,KAAqC,sDAArC,CACA,MAAOC,CAAAA,QAAP,KAAqB,gBAArB,CACA,OAASC,SAAT,CAAoBC,SAApB,CAA+BC,4BAA/B,CAA6DC,WAA7D,KAAgF,aAAhF,CACA,OAASC,UAAT,KAA2B,wBAA3B,CACA,MAAOC,CAAAA,IAAP,KAAiB,mCAAjB,CACA,MAAOC,CAAAA,QAAP,KAAqB,QAArB,C,wFAGA,GAAMC,CAAAA,IAAc,CAAG,QAAjBA,CAAAA,IAAiB,EAAM,oBACVjB,aAAa,EADH,CACnBkB,IADmB,gBACnBA,IADmB,gBAEPhB,SAAS,EAFF,CAEnBiB,OAFmB,YAEnBA,OAFmB,CAG3B,GAAMC,CAAAA,MAAM,CAAGV,SAAS,CAACS,OAAD,CAAxB,CACA,GAAME,CAAAA,MAAM,CAAGV,SAAS,EAAxB,CACA,GAAMW,CAAAA,KAAK,CAAGb,QAAQ,EAAtB,CACA,GAAMc,CAAAA,YAAY,CAAGH,MAAM,CAACI,GAAP,CAAW,SAACC,KAAD,CAAW,CACzC,GAAIC,CAAAA,WAAW,CAAG,GAAIzB,CAAAA,SAAJ,CAAcwB,KAAK,CAACE,eAApB,EAAqCC,KAArC,CAA2CH,KAAK,CAACI,WAAjD,EAA8DC,GAA9D,CAAkE,GAAI7B,CAAAA,SAAJ,CAAc,EAAd,EAAkB8B,GAAlB,CAAsB,EAAtB,CAAlE,CAAlB,CACA,GAAIN,KAAK,CAACO,aAAV,CAAyB,CAAEN,WAAW,CAAG,GAAIzB,CAAAA,SAAJ,CAAcwB,KAAK,CAACI,WAApB,EAAiCC,GAAjC,CAAqC,GAAI7B,CAAAA,SAAJ,CAAc,EAAd,EAAkB8B,GAAlB,CAAsB,EAAtB,CAArC,EAAgED,GAAhE,CAAoE,CAApE,CAAd,CAAsF,CACjH,GAAMG,CAAAA,GAAG,CAAGrB,4BAA4B,CAACc,WAAD,CAAcD,KAAK,CAACS,gBAApB,CAAsCb,MAAtC,CAAxC,CACA,GAAMc,CAAAA,gBAAgB,CAAGtB,WAAW,CAACC,UAAU,CAACsB,IAAZ,CAAkBf,MAAlB,CAApC,CACA,GAAMgB,CAAAA,uBAAuB,CAAGF,gBAAgB,CAACP,KAAjB,CAAuBH,KAAK,CAACa,aAA7B,EAA4CV,KAA5C,CAAkDzB,eAAlD,CAAhC,CACA,GAAMoC,CAAAA,GAAG,CAAGF,uBAAuB,CAACP,GAAxB,CAA4BG,GAA5B,EAAiCL,KAAjC,CAAuC,GAAvC,CAAZ,CACA,sCAAYH,KAAZ,MAAmBe,UAAU,CAAEf,KAAK,CAACgB,MAAN,GAAiB,CAAjB,CAAqB,KAArB,CAA6BhB,KAAK,CAACe,UAAN,EAAoBlB,KAAK,CAAGG,KAAK,CAACiB,QAA9F,CAAwGH,GAAG,CAAHA,GAAxG,CAA6GN,GAAG,CAAHA,GAA7G,GACA;AACA;AACA;AACA;AACA;AACD,CAboB,CAArB,CAN2B,eAoBQ3B,SAAS,CAACiB,YAAD,CAAe,SAACE,KAAD,QAAWA,CAAAA,KAAK,CAACe,UAAjB,EAAf,CApBjB,0CAoBpBG,aApBoB,gBAoBLC,SApBK,oCAqBF5C,aAAa,EArBX,CAqBnB6C,GArBmB,iBAqBnBA,GArBmB,CAqBdC,OArBc,iBAqBdA,OArBc,eAsBOjD,QAAQ,CAAC,IAAD,CAtBf,wCAsBpBkD,SAtBoB,eAsBTC,YAtBS,eAuB3B,GAAMC,CAAAA,WAAW,0FAAG,mIAClBD,YAAY,CAAC,CAACD,SAAF,CAAZ,CADkB,sDAAH,kBAAXE,CAAAA,WAAW,0CAAjB,CAIA,mBACE,MAAC,IAAD,yBAEE,KAAC,KAAD,EAAO,IAAI,WAAK/B,IAAL,CAAX,UACGb,OAAO,CAACuC,SAAD,CAAY,CAAC,WAAD,CAAZ,CAAP,CAAkCpB,GAAlC,CAAsC,SAACC,KAAD,qBAAY,KAAC,QAAD,EAA6B,KAAK,CAAEA,KAApC,EAAeA,KAAK,CAACgB,MAArB,CAAZ,EAAtC,CADH,EAFF,cAKE,KAAC,KAAD,EAAO,IAAI,WAAKvB,IAAL,aAAX,UACGb,OAAO,CAACsC,aAAD,CAAgB,CAAC,WAAD,CAAhB,CAAP,CAAsCnB,GAAtC,CAA0C,SAACC,KAAD,qBAAY,KAAC,QAAD,EAA6B,KAAK,CAAEA,KAApC,EAAeA,KAAK,CAACgB,MAArB,CAAZ,EAA1C,CADH,EALF,cASE,MAAC,wBAAD,yBACE,YACE,KAAK,CAAE,CACLS,OAAO,CAAE,aADJ,CAELC,YAAY,CAAE,EAFT,CAGLC,QAAQ,CAAE,QAHL,CADT,uBAOE,KAAC,OAAD,wBACE,KAAC,oBAAD,EAAsB,EAAE,CAAEtD,IAA1B,CAAgC,SAAS,CAAC,WAA1C,CAAsD,EAAE,WAAK+C,GAAL,CAAxD,oBADF,EAPF,EADF,cAcE,YACE,KAAK,CAAE,CACLK,OAAO,CAAE,aADJ,CAELC,YAAY,CAAE,EAFT,CAGLC,QAAQ,CAAE,QAHL,CADT,uBAOE,KAAC,OAAD,wBACE,KAAC,oBAAD,EAAsB,EAAE,CAAEtD,IAA1B,CAAgC,SAAS,CAAC,WAA1C,CAAsD,EAAE,WAAK+C,GAAL,aAAxD,sBADF,EAPF,EAdF,GATF,GADF,CAsCD,CAjED,CAmEA,cAAe5B,CAAAA,IAAf","sourcesContent":["import React, { useState } from 'react'\nimport { Link, Route, useRouteMatch } from 'react-router-dom'\nimport BigNumber from 'bignumber.js'\nimport { useWallet } from '@binance-chain/bsc-use-wallet'\nimport { BLOCKS_PER_YEAR } from 'config'\nimport Ripples, { createRipples } from 'react-ripples'\nimport orderBy from 'lodash/orderBy'\nimport partition from 'lodash/partition'\nimport ActiveInactiveButton from 'components/layout/buttons/activeInactiveButton'\nimport ActiveInactiveContatiner from 'components/layout/containers/activeInactiveContainer'\nimport useBlock from 'hooks/useBlock'\nimport { usePools2, usePrices, getTotalValueFromQuoteTokens, lookupPrice } from 'state/hooks'\nimport { QuoteToken } from 'config/constants/types'\nimport Page from 'components/layout/containers/page'\nimport PoolCard from './card'\n\n\nconst Bond: React.FC = () => {\n  const { path } = useRouteMatch()\n  const { account } = useWallet()\n  const pools2 = usePools2(account)\n  const prices = usePrices()\n  const block = useBlock()\n  const poolsWithApy = pools2.map((pool2) => {\n    let quoteTokens = new BigNumber(pool2.quoteTokenPerLp).times(pool2.totalStaked).div(new BigNumber(10).pow(18))\n    if (pool2.isSingleAsset) { quoteTokens = new BigNumber(pool2.totalStaked).div(new BigNumber(10).pow(18)).div(2) }\n    const tvl = getTotalValueFromQuoteTokens(quoteTokens, pool2.quoteTokenSymbol, prices)\n    const rewardTokenPrice = lookupPrice(QuoteToken.RVRS, prices)\n    const totalRewardPricePerYear = rewardTokenPrice.times(pool2.tokenPerBlock).times(BLOCKS_PER_YEAR)\n    const apy = totalRewardPricePerYear.div(tvl).times(100)\n    return { ...pool2, isFinished: pool2.sousId === 0 ? false : pool2.isFinished && block > pool2.endBlock, apy, tvl }\n    // console.log(pool2.sousId, quoteTokens && quoteTokens.toNumber(), tvl && tvl.toNumber())\n    // console.log(\"APY\", pool2, tvl && tvl.toNumber())\n    // console.log(\"TVL\", pool2.stakingTokenName, tvl && tvl.toNumber(), apy && apy.toNumber())\n    // const totalStakingTokenInPool = stakingTokenPriceInBNB.times(getBalanceNumber(pool2.totalStaked))\n    // console.log(\"price\", pool2.tokenName, rewardTokenPrice && rewardTokenPrice.toNumber())\n  })\n  const [finishedPools, openPools] = partition(poolsWithApy, (pool2) => pool2.isFinished)\n  const { url, isExact } = useRouteMatch()\n  const [modalOpen, setModalOpen] = useState(true)\n  const handleModal = async () => {\n    setModalOpen(!modalOpen)\n  }\n\n  return (\n    <Page>\n      { /* Bonds card layout */}\n      <Route path={`${path}`}>\n        {orderBy(openPools, ['sortOrder']).map((pool2) => (<PoolCard key={pool2.sousId} pool2={pool2} />))}\n      </Route>\n      <Route path={`${path}/inactive`}>\n        {orderBy(finishedPools, ['sortOrder']).map((pool2) => (<PoolCard key={pool2.sousId} pool2={pool2} />))}\n      </Route>\n      { /* Active/Inactive button */}\n      <ActiveInactiveContatiner>\n        <div\n          style={{\n            display: 'inline-flex',\n            borderRadius: 25,\n            overflow: 'hidden',\n          }}\n        >\n          <Ripples>\n            <ActiveInactiveButton as={Link} className=\"nav-links\" to={`${url}`}>\n              Active\n            </ActiveInactiveButton>\n          </Ripples>\n        </div>\n        <div\n          style={{\n            display: 'inline-flex',\n            borderRadius: 15,\n            overflow: 'hidden',\n          }}\n        >\n          <Ripples>\n            <ActiveInactiveButton as={Link} className=\"nav-links\" to={`${url}/inactive`}>Inactive</ActiveInactiveButton>\n          </Ripples>\n        </div>\n      </ActiveInactiveContatiner>\n    </Page>\n  )\n}\n\nexport default Bond\n\n\n"]},"metadata":{},"sourceType":"module"}