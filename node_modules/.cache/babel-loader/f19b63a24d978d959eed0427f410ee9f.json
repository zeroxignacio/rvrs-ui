{"ast":null,"code":"import _taggedTemplateLiteral from\"/Users/ignacio/Documents/GitHub/reverse-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";import _regeneratorRuntime from\"/Users/ignacio/Documents/GitHub/reverse-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/ignacio/Documents/GitHub/reverse-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/ignacio/Documents/GitHub/reverse-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";var _templateObject,_templateObject2,_templateObject3;import BigNumber from'bignumber.js';import React,{useCallback,useState}from'react';import styled from'styled-components';import{useModal}from'@pancakeswap-libs/uikit';import{useWallet}from'@binance-chain/bsc-use-wallet';import{useERC20}from'hooks/useContract';import{useSousApprove}from'hooks/useApprove';import{useSousStake}from'hooks/useStake';import{useSousUnstake}from'hooks/useUnstake';import{getBalanceNumber}from'utils/formatBalance';import{QuoteToken,PoolCategory}from'config/constants/types';import{Skeleton}from'components/Skeleton';import useTokenBalance from'hooks/useTokenBalance';import{getCakeAddress}from'utils/addressHelpers';import Typography from'components/layout/typography/typography';import{Flex}from'components/layout/flex';import TypographyBold from'components/layout/typography/typographyBold';import TypographyTitle from'components/layout/typography/typographyTitle';import WithdrawModal from'./modals/withdrawModal';import StakeModal from'./modals/stakeModal';import{usePriceCakeBusd}from\"../../state/hooks\";import ContentCard from'./containers/contentCard';import ContentCard2 from'./containers/contentCard2';import ContentCardMain from'./containers/contentCardMain';import TitleCard from'./containers/titleCard';import Container from'./containers/container';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Card=function Card(_ref){var pool=_ref.pool;var sousId=pool.sousId,stakingTokenName=pool.stakingTokenName,stakingTokenAddress=pool.stakingTokenAddress,apy=pool.apy,tokenDecimals=pool.tokenDecimals,poolCategory=pool.poolCategory,isFinished=pool.isFinished,userData=pool.userData,stakingLimit=pool.stakingLimit,pricePerShare=pool.pricePerShare;// rvrs\nvar rvrsBalance=getBalanceNumber(useTokenBalance(getCakeAddress()));var rvrsBalanceStr=rvrsBalance.toLocaleString('en-us',{maximumFractionDigits:2,minimumFractionDigits:2});var rvrsPrice=usePriceCakeBusd();var isBnbPool=poolCategory===PoolCategory.BINANCE;var stakingTokenContract=useERC20(stakingTokenAddress);// func\nvar _useWallet=useWallet(),account=_useWallet.account;var _useSousApprove=useSousApprove(stakingTokenContract,sousId),onApprove=_useSousApprove.onApprove;var _useSousStake=useSousStake(sousId,isBnbPool),onStake=_useSousStake.onStake;var _useSousUnstake=useSousUnstake(sousId),onUnstake=_useSousUnstake.onUnstake;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),requestedApproval=_useState2[0],setRequestedApproval=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),pendingTx=_useState4[0],setPendingTx=_useState4[1];var allowance=new BigNumber((userData===null||userData===void 0?void 0:userData.allowance)||0);var stakingTokenBalance=new BigNumber((userData===null||userData===void 0?void 0:userData.stakingTokenBalance)||0);var isOldSyrup=stakingTokenName===QuoteToken.SYRUP;var convertedLimit=new BigNumber(stakingLimit).multipliedBy(new BigNumber(10).pow(tokenDecimals));// staked\nvar staked=new BigNumber((userData===null||userData===void 0?void 0:userData.stakedBalance)||0);var stakedUsdStr=new BigNumber(getBalanceNumber(staked)).times(rvrsPrice).toNumber().toLocaleString('en-us',{maximumFractionDigits:2,minimumFractionDigits:2});var stakedNo=getBalanceNumber(staked);var stakedStr=stakedNo.toLocaleString('en-us',{maximumFractionDigits:2,minimumFractionDigits:2});// misc\nvar accountHasStakedBalance=(staked===null||staked===void 0?void 0:staked.toNumber())>0;var needsApproval=!accountHasStakedBalance&&!allowance.toNumber()&&!isBnbPool;// tvl\nvar tvlNo=pool.tvl&&pool.tvl.toNumber();var tvlStr=tvlNo.toLocaleString('en-us',{maximumFractionDigits:0,minimumFractionDigits:0});// apy\nvar apyNo=apy&&apy.toNumber();var apyStr=apy&&apy.toNumber().toLocaleString('en-us',{maximumFractionDigits:2,minimumFractionDigits:2});var monthlyRoiStr=apy&&apy.div(12).toNumber().toLocaleString('en-us',{maximumFractionDigits:2,minimumFractionDigits:2});// approve, withdraw, deposit\nvar _useModal=useModal(/*#__PURE__*/_jsx(WithdrawModal,{max:staked,onConfirm:onUnstake,tokenName:stakingTokenName,pricePerShare:pricePerShare})),_useModal2=_slicedToArray(_useModal,1),onPresentWithdraw=_useModal2[0];var handleApprove=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var txHash;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;setRequestedApproval(true);_context.next=4;return onApprove();case 4:txHash=_context.sent;// user rejected tx or didn't go thru\nif(!txHash){setRequestedApproval(false);}_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);console.error(_context.t0);case 11:case\"end\":return _context.stop();}}},_callee,null,[[0,8]]);})),[onApprove,setRequestedApproval]);var _useModal3=useModal(/*#__PURE__*/_jsx(StakeModal,{max:stakingLimit&&stakingTokenBalance.isGreaterThan(convertedLimit)?convertedLimit:stakingTokenBalance,onConfirm:onStake,tokenName:stakingLimit?\"\".concat(stakingTokenName,\" (\").concat(stakingLimit,\" max)\"):stakingTokenName})),_useModal4=_slicedToArray(_useModal3,1),onPresentDeposit=_useModal4[0];return/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsxs(TitleCard,{style:{marginBottom:'10px'},children:[/*#__PURE__*/_jsx(TypographyTitle,{children:\"RVRS Staking\\xA0\"}),/*#__PURE__*/_jsxs(\"a\",{target:\"_blanK\",rel:\"noreferrer\",href:\"https://medium.com/@reverseprotocolONE/diamond-hands-through-vervrs-46dad3106d3\",className:\"nav-links\",children:[\"(\",/*#__PURE__*/_jsx(TypographyTitle,{style:{marginTop:'15px',marginBottom:'15px',marginLeft:'0px',borderBottom:'1px dotted #FFFF'},children:\"Soon Deprecated\"}),\")\"]})]}),/*#__PURE__*/_jsxs(Flex,{justifyContent:\"center\",marginBottom:\"10px\",children:[/*#__PURE__*/_jsxs(ContentCard,{style:{marginRight:'7px'},children:[pool.apy?/*#__PURE__*/_jsxs(TypographyBold,{style:{marginBottom:'5px'},children:[\"$\",tvlStr]}):/*#__PURE__*/_jsx(Typography,{children:/*#__PURE__*/_jsx(Skeleton,{height:10,width:60,marginBottom:\"5px\"})}),/*#__PURE__*/_jsx(Typography,{children:\"TVL\"})]}),/*#__PURE__*/_jsxs(ContentCardMain,{children:[pool.apy?/*#__PURE__*/_jsxs(TypographyBold,{style:{marginBottom:'5px'},children:[apyStr,\"%\"]}):/*#__PURE__*/_jsx(Typography,{children:/*#__PURE__*/_jsx(Skeleton,{height:10,marginBottom:\"5px\"})}),/*#__PURE__*/_jsx(Typography,{children:\"Annual Yield\"})]}),/*#__PURE__*/_jsxs(ContentCard,{style:{marginLeft:'7px'},children:[pool.apy?/*#__PURE__*/_jsxs(TypographyBold,{style:{marginBottom:'5px'},children:[monthlyRoiStr,\"%\"]}):/*#__PURE__*/_jsx(Typography,{children:/*#__PURE__*/_jsx(Skeleton,{height:10,marginBottom:\"5px\"})}),/*#__PURE__*/_jsx(Typography,{children:\"Monthly ROI\"})]})]}),/*#__PURE__*/_jsxs(Flex,{justifyContent:\"center\",children:[/*#__PURE__*/_jsxs(ContentCard2,{style:{marginRight:'7px'},children:[pool.apy?/*#__PURE__*/_jsx(TypographyBold,{style:{marginBottom:'5px'},children:stakedStr}):/*#__PURE__*/_jsx(Typography,{children:/*#__PURE__*/_jsx(Skeleton,{height:10,marginBottom:\"5px\"})}),/*#__PURE__*/_jsx(Typography,{children:\"Staked RVRS\"})]}),/*#__PURE__*/_jsxs(ContentCard2,{children:[pool.apy?/*#__PURE__*/_jsxs(TypographyBold,{style:{marginBottom:'5px'},children:[\"$\",stakedUsdStr]}):/*#__PURE__*/_jsx(Typography,{children:/*#__PURE__*/_jsx(Skeleton,{height:10,marginBottom:\"5px\"})}),/*#__PURE__*/_jsx(Typography,{children:\"Staked (USD)\"})]})]}),/*#__PURE__*/_jsx(Divider,{}),account&&(!needsApproval?/*#__PURE__*/_jsx(Flex,{justifyContent:\"center\",marginTop:\"0px\",marginBottom:\"20px\",children:stakedNo>0?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(UnstakeButton,{style:{marginRight:\"12px\"},disabled:staked.eq(new BigNumber(0))||pendingTx,onClick:isOldSyrup?/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:setPendingTx(true);_context2.next=3;return onUnstake('0');case 3:setPendingTx(false);case 4:case\"end\":return _context2.stop();}}},_callee2);})):onPresentWithdraw,children:\"Unstake\"}),/*#__PURE__*/_jsx(StakeButton,{disabled:isFinished&&sousId!==0,onClick:onPresentDeposit,children:\"\\xA0Stake\\xA0\"})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(UnstakeButton,{style:{marginRight:\"12px\"},disabled:true,onClick:isOldSyrup?/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:setPendingTx(true);_context3.next=3;return onUnstake('0');case 3:setPendingTx(false);case 4:case\"end\":return _context3.stop();}}},_callee3);})):onPresentWithdraw,children:\"Unstake\"}),/*#__PURE__*/_jsx(StakeButton,{disabled:isFinished&&sousId!==0,onClick:onPresentDeposit,children:\"\\xA0Stake\\xA0\"})]})}):/*#__PURE__*/_jsx(StakeButton,{style:{marginTop:\"0px\",marginBottom:\"20px\"},disabled:requestedApproval,onClick:handleApprove,children:\"Enable\"}))]});};var StakeButton=styled.button(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  font-size: 18px;\\n  font-weight: 600;\\n  color: #E2E2E2;\\n  justify-content: center;\\n  background-image: linear-gradient(180deg, #506063, #909BBF);\\n  border-radius: 15px;\\n  border: 0px;\\n  padding-left: 110px;\\n  padding-right: 110px;\\n  padding-top: 17px;\\n  padding-bottom: 17px;\\n  :hover {\\n    background-image: linear-gradient(180deg, #506063, #A1ACCD);\\n    box-shadow: 0px 0px 10px 0px #5A6F73;\\n    transition: 0.5s;\\n    color: #FFFF;\\n  }\\n\"])));var UnstakeButton=styled.button(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  font-size: 18px;\\n  font-weight: 600;\\n  color: #C7CBD0;\\n  justify-content: center;\\n  background-color: #46505E;\\n  border-radius: 15px;\\n  border: 0px;\\n  padding-left: 110px;\\n  padding-right: 100px;\\n  padding-top: 17px;\\n  padding-bottom: 17px;\\n  :hover {\\n      background-color: #535E6F;\\n      transition: 0.3s;\\n      color: #FFFF;\\n  } \\n\"])));var Divider=styled.div(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n  background-color: #9B9B9B;\\n  height: 1px;\\n  margin-left: auto;\\n  margin-right: auto;\\n  margin-top: 25px;\\n  width: 0%;\\n\"])));export default Card;","map":{"version":3,"sources":["/Users/ignacio/Documents/GitHub/reverse-frontend/src/pages/Staking/card.tsx"],"names":["BigNumber","React","useCallback","useState","styled","useModal","useWallet","useERC20","useSousApprove","useSousStake","useSousUnstake","getBalanceNumber","QuoteToken","PoolCategory","Skeleton","useTokenBalance","getCakeAddress","Typography","Flex","TypographyBold","TypographyTitle","WithdrawModal","StakeModal","usePriceCakeBusd","ContentCard","ContentCard2","ContentCardMain","TitleCard","Container","Card","pool","sousId","stakingTokenName","stakingTokenAddress","apy","tokenDecimals","poolCategory","isFinished","userData","stakingLimit","pricePerShare","rvrsBalance","rvrsBalanceStr","toLocaleString","maximumFractionDigits","minimumFractionDigits","rvrsPrice","isBnbPool","BINANCE","stakingTokenContract","account","onApprove","onStake","onUnstake","requestedApproval","setRequestedApproval","pendingTx","setPendingTx","allowance","stakingTokenBalance","isOldSyrup","SYRUP","convertedLimit","multipliedBy","pow","staked","stakedBalance","stakedUsdStr","times","toNumber","stakedNo","stakedStr","accountHasStakedBalance","needsApproval","tvlNo","tvl","tvlStr","apyNo","apyStr","monthlyRoiStr","div","onPresentWithdraw","handleApprove","txHash","console","error","isGreaterThan","onPresentDeposit","marginBottom","marginTop","marginLeft","borderBottom","marginRight","eq","StakeButton","button","UnstakeButton","Divider"],"mappings":"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","sourcesContent":["import BigNumber from 'bignumber.js'\nimport React, { useCallback, useState } from 'react'\nimport styled from 'styled-components'\nimport { useModal } from '@pancakeswap-libs/uikit'\nimport { useWallet } from '@binance-chain/bsc-use-wallet'\nimport { useERC20 } from 'hooks/useContract'\nimport { useSousApprove } from 'hooks/useApprove'\nimport { useSousStake } from 'hooks/useStake'\nimport { useSousUnstake } from 'hooks/useUnstake'\nimport { getBalanceNumber } from 'utils/formatBalance'\nimport { QuoteToken, PoolCategory } from 'config/constants/types'\nimport { Pool } from 'state/types'\nimport { Skeleton } from 'components/Skeleton'\nimport useTokenBalance from 'hooks/useTokenBalance'\nimport { getCakeAddress } from 'utils/addressHelpers'\nimport Typography from 'components/layout/typography/typography'\nimport { Flex } from 'components/layout/flex'\nimport TypographyBold from 'components/layout/typography/typographyBold'\nimport TypographyTitle from 'components/layout/typography/typographyTitle'\nimport WithdrawModal from './modals/withdrawModal'\nimport StakeModal from './modals/stakeModal'\nimport { usePriceCakeBusd } from \"../../state/hooks\";\nimport ContentCard from './containers/contentCard'\nimport ContentCard2 from './containers/contentCard2'\nimport ContentCardMain from './containers/contentCardMain'\nimport TitleCard from './containers/titleCard'\nimport Container from './containers/container'\n\ninterface PoolWithApy extends Pool {\n  apy: BigNumber\n  apr: BigNumber\n}\n\ninterface HarvestProps {\n  pool: PoolWithApy\n}\n\nconst Card: React.FC<HarvestProps> = ({ pool }) => {\n  const { sousId, stakingTokenName, stakingTokenAddress, apy, tokenDecimals, poolCategory, isFinished, userData, stakingLimit, pricePerShare } = pool\n\n  // rvrs\n  const rvrsBalance = getBalanceNumber(useTokenBalance(getCakeAddress()));\n  const rvrsBalanceStr = rvrsBalance.toLocaleString('en-us', { maximumFractionDigits: 2, minimumFractionDigits: 2 });\n  const rvrsPrice = usePriceCakeBusd()\n\n  const isBnbPool = poolCategory === PoolCategory.BINANCE\n  const stakingTokenContract = useERC20(stakingTokenAddress)\n\n  // func\n  const { account } = useWallet()\n  const { onApprove } = useSousApprove(stakingTokenContract, sousId)\n  const { onStake } = useSousStake(sousId, isBnbPool)\n  const { onUnstake } = useSousUnstake(sousId)\n\n  const [requestedApproval, setRequestedApproval] = useState(false)\n  const [pendingTx, setPendingTx] = useState(false)\n\n  const allowance = new BigNumber(userData?.allowance || 0)\n  const stakingTokenBalance = new BigNumber(userData?.stakingTokenBalance || 0)\n  const isOldSyrup = stakingTokenName === QuoteToken.SYRUP\n  const convertedLimit = new BigNumber(stakingLimit).multipliedBy(new BigNumber(10).pow(tokenDecimals))\n\n  // staked\n  const staked = new BigNumber(userData?.stakedBalance || 0);\n  const stakedUsdStr = new BigNumber(getBalanceNumber(staked)).times(rvrsPrice).toNumber().toLocaleString('en-us', { maximumFractionDigits: 2, minimumFractionDigits: 2 });\n  const stakedNo = getBalanceNumber(staked);\n  const stakedStr = stakedNo.toLocaleString('en-us', { maximumFractionDigits: 2, minimumFractionDigits: 2 });\n\n  // misc\n  const accountHasStakedBalance = staked?.toNumber() > 0;\n  const needsApproval = !accountHasStakedBalance && !allowance.toNumber() && !isBnbPool;\n\n  // tvl\n  const tvlNo = pool.tvl && pool.tvl.toNumber();\n  const tvlStr = tvlNo.toLocaleString('en-us', { maximumFractionDigits: 0, minimumFractionDigits: 0 });\n\n  // apy\n  const apyNo = apy && apy.toNumber();\n  const apyStr = apy && apy.toNumber().toLocaleString('en-us', { maximumFractionDigits: 2, minimumFractionDigits: 2 });\n  const monthlyRoiStr = apy && apy.div(12).toNumber().toLocaleString('en-us', { maximumFractionDigits: 2, minimumFractionDigits: 2 });\n\n  // approve, withdraw, deposit\n  const [onPresentWithdraw] = useModal(\n    <WithdrawModal max={staked} onConfirm={onUnstake} tokenName={stakingTokenName} pricePerShare={pricePerShare} />,\n  )\n  const handleApprove = useCallback(async () => {\n    try {\n      setRequestedApproval(true)\n      const txHash = await onApprove()\n      // user rejected tx or didn't go thru\n      if (!txHash) {\n        setRequestedApproval(false)\n      }\n    } catch (e) {\n      console.error(e)\n    }\n  }, [onApprove, setRequestedApproval])\n  const [onPresentDeposit] = useModal(\n    <StakeModal\n      max={stakingLimit && stakingTokenBalance.isGreaterThan(convertedLimit) ? convertedLimit : stakingTokenBalance}\n      onConfirm={onStake}\n      tokenName={stakingLimit ? `${stakingTokenName} (${stakingLimit} max)` : stakingTokenName}\n    />,\n  )\n\n  return (\n    <Container>\n      <TitleCard style={{ marginBottom: '10px' }}>\n        <TypographyTitle>RVRS Staking&nbsp;</TypographyTitle>\n        <a target=\"_blanK\" rel=\"noreferrer\" href=\"https://medium.com/@reverseprotocolONE/diamond-hands-through-vervrs-46dad3106d3\" className=\"nav-links\">\n          (<TypographyTitle style={{ marginTop: '15px', marginBottom: '15px', marginLeft: '0px', borderBottom: '1px dotted #FFFF' }}>Soon Deprecated</TypographyTitle>)\n        </a>\n      </TitleCard>\n      <Flex justifyContent=\"center\" marginBottom=\"10px\">\n        <ContentCard style={{ marginRight: '7px' }}>\n          {pool.apy ?\n            <TypographyBold style={{ marginBottom: '5px' }}>${tvlStr}</TypographyBold>\n            :\n            <Typography><Skeleton height={10} width={60} marginBottom=\"5px\" /></Typography>\n          }\n          <Typography>TVL</Typography>\n        </ContentCard>\n        <ContentCardMain>\n          {pool.apy ?\n            <TypographyBold style={{ marginBottom: '5px' }}>{apyStr}%</TypographyBold>\n            :\n            <Typography><Skeleton height={10} marginBottom=\"5px\" /></Typography>\n          }\n          <Typography>Annual Yield</Typography>\n        </ContentCardMain>\n        <ContentCard style={{ marginLeft: '7px' }}>\n          {pool.apy ?\n            <TypographyBold style={{ marginBottom: '5px' }}>{monthlyRoiStr}%</TypographyBold>\n            :\n            <Typography><Skeleton height={10} marginBottom=\"5px\" /></Typography>\n          }\n          <Typography>Monthly ROI</Typography>\n        </ContentCard>\n      </Flex>\n      <Flex justifyContent=\"center\">\n        <ContentCard2 style={{ marginRight: '7px' }}>\n          {pool.apy ?\n            <TypographyBold style={{ marginBottom: '5px' }}>{stakedStr}</TypographyBold>\n            :\n            <Typography><Skeleton height={10} marginBottom=\"5px\" /></Typography>\n          }\n          <Typography>Staked RVRS</Typography>\n        </ContentCard2>\n        <ContentCard2>\n          {pool.apy ?\n            <TypographyBold style={{ marginBottom: '5px' }}>${stakedUsdStr}</TypographyBold>\n            :\n            <Typography><Skeleton height={10} marginBottom=\"5px\" /></Typography>\n          }\n          <Typography>Staked (USD)</Typography>\n        </ContentCard2>\n      </Flex>\n      <Divider />\n      {account && (!needsApproval ? (\n        <Flex justifyContent=\"center\" marginTop=\"0px\" marginBottom=\"20px\">\n          {stakedNo > 0 ?\n            <>\n              <UnstakeButton\n                style={{ marginRight: \"12px\" }}\n                disabled={staked.eq(new BigNumber(0)) || pendingTx}\n                onClick={isOldSyrup ? async () => {\n                  setPendingTx(true)\n                  await onUnstake('0')\n                  setPendingTx(false)\n                } : onPresentWithdraw}>\n                Unstake\n              </UnstakeButton>\n              <StakeButton\n                disabled={isFinished && sousId !== 0}\n                onClick={onPresentDeposit}>\n                &nbsp;Stake&nbsp;\n              </StakeButton>\n            </>\n            :\n            <>\n              <UnstakeButton\n                style={{ marginRight: \"12px\" }}\n                disabled\n                onClick={isOldSyrup ? async () => {\n                  setPendingTx(true)\n                  await onUnstake('0')\n                  setPendingTx(false)\n                } : onPresentWithdraw}>\n                Unstake\n              </UnstakeButton>\n              <StakeButton\n                disabled={isFinished && sousId !== 0}\n                onClick={onPresentDeposit}\n              >\n                &nbsp;Stake&nbsp;\n              </StakeButton>\n            </>\n          }\n        </Flex>\n      ) : (\n        <StakeButton\n          style={{ marginTop: \"0px\", marginBottom: \"20px\" }}\n          disabled={requestedApproval}\n          onClick={handleApprove}>\n          Enable\n        </StakeButton>\n      ))}\n    </Container>\n  )\n}\n\nconst StakeButton = styled.button`\n  font-size: 18px;\n  font-weight: 600;\n  color: #E2E2E2;\n  justify-content: center;\n  background-image: linear-gradient(180deg, #506063, #909BBF);\n  border-radius: 15px;\n  border: 0px;\n  padding-left: 110px;\n  padding-right: 110px;\n  padding-top: 17px;\n  padding-bottom: 17px;\n  :hover {\n    background-image: linear-gradient(180deg, #506063, #A1ACCD);\n    box-shadow: 0px 0px 10px 0px #5A6F73;\n    transition: 0.5s;\n    color: #FFFF;\n  }\n`\n\nconst UnstakeButton = styled.button`\n  font-size: 18px;\n  font-weight: 600;\n  color: #C7CBD0;\n  justify-content: center;\n  background-color: #46505E;\n  border-radius: 15px;\n  border: 0px;\n  padding-left: 110px;\n  padding-right: 100px;\n  padding-top: 17px;\n  padding-bottom: 17px;\n  :hover {\n      background-color: #535E6F;\n      transition: 0.3s;\n      color: #FFFF;\n  } \n`\n\nconst Divider = styled.div`\n  background-color: #9B9B9B;\n  height: 1px;\n  margin-left: auto;\n  margin-right: auto;\n  margin-top: 25px;\n  width: 0%;\n`\n\nexport default Card\n"]},"metadata":{},"sourceType":"module"}