{"ast":null,"code":"import{useContext}from'react';import{TranslationsContext}from'../contexts/Localisation/translationsContext';var variableRegex=/%(.*?)%/;var replaceDynamicString=function replaceDynamicString(foundTranslation,fallback){var stringToReplace=variableRegex.exec(foundTranslation)[0];// const indexToReplace = foundTranslation.split(' ').indexOf(stringToReplace)\nvar fallbackValueAtIndex=fallback.split(' ')[0];return foundTranslation.replace(stringToReplace,fallbackValueAtIndex);};export var getTranslation=function getTranslation(translations,translationId,fallback){var foundTranslation=translations.find(function(translation){return translation.data.stringId===translationId;});if(foundTranslation){var translatedString=foundTranslation.data.text;var includesVariable=translatedString.includes('%');if(includesVariable){return replaceDynamicString(translatedString,fallback);}return translatedString;}return fallback;};// TODO: Replace instances where this is called directly with the \"useI18n\" hook.\n// Using this directly can lead to errors because \"useContext\" is not preserved between renders\n// @see https://reactjs.org/docs/hooks-rules.html\nexport var TranslateString=function TranslateString(translationId,fallback){var _useContext=useContext(TranslationsContext),translations=_useContext.translations;if(translations[0]==='error'){return fallback;}if(translations.length>0){return getTranslation(translations,translationId,fallback);}return fallback;};","map":{"version":3,"sources":["/Users/ignacio/Documents/GitHub/reverse-frontend/src/utils/translateTextHelpers.ts"],"names":["useContext","TranslationsContext","variableRegex","replaceDynamicString","foundTranslation","fallback","stringToReplace","exec","fallbackValueAtIndex","split","replace","getTranslation","translations","translationId","find","translation","data","stringId","translatedString","text","includesVariable","includes","TranslateString","length"],"mappings":"AAAA,OAASA,UAAT,KAA2B,OAA3B,CACA,OAASC,mBAAT,KAAoC,8CAApC,CAEA,GAAMC,CAAAA,aAAa,CAAG,SAAtB,CAEA,GAAMC,CAAAA,oBAAoB,CAAG,QAAvBA,CAAAA,oBAAuB,CAACC,gBAAD,CAA2BC,QAA3B,CAAgD,CAC3E,GAAMC,CAAAA,eAAe,CAAGJ,aAAa,CAACK,IAAd,CAAmBH,gBAAnB,EAAqC,CAArC,CAAxB,CACA;AACA,GAAMI,CAAAA,oBAAoB,CAAGH,QAAQ,CAACI,KAAT,CAAe,GAAf,EAAoB,CAApB,CAA7B,CACA,MAAOL,CAAAA,gBAAgB,CAACM,OAAjB,CAAyBJ,eAAzB,CAA0CE,oBAA1C,CAAP,CACD,CALD,CAOA,MAAO,IAAMG,CAAAA,cAAc,CAAG,QAAjBA,CAAAA,cAAiB,CAACC,YAAD,CAA2BC,aAA3B,CAAkDR,QAAlD,CAAuE,CACnG,GAAMD,CAAAA,gBAAgB,CAAGQ,YAAY,CAACE,IAAb,CAAkB,SAACC,WAAD,CAAiB,CAC1D,MAAOA,CAAAA,WAAW,CAACC,IAAZ,CAAiBC,QAAjB,GAA8BJ,aAArC,CACD,CAFwB,CAAzB,CAGA,GAAIT,gBAAJ,CAAsB,CACpB,GAAMc,CAAAA,gBAAgB,CAAGd,gBAAgB,CAACY,IAAjB,CAAsBG,IAA/C,CACA,GAAMC,CAAAA,gBAAgB,CAAGF,gBAAgB,CAACG,QAAjB,CAA0B,GAA1B,CAAzB,CACA,GAAID,gBAAJ,CAAsB,CACpB,MAAOjB,CAAAA,oBAAoB,CAACe,gBAAD,CAAmBb,QAAnB,CAA3B,CACD,CACD,MAAOa,CAAAA,gBAAP,CACD,CACD,MAAOb,CAAAA,QAAP,CACD,CAbM,CAeP;AACA;AACA;AACA,MAAO,IAAMiB,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,CAACT,aAAD,CAAwBR,QAAxB,CAA6C,CAC1E,gBAAyBL,UAAU,CAACC,mBAAD,CAAnC,CAAQW,YAAR,aAAQA,YAAR,CACA,GAAIA,YAAY,CAAC,CAAD,CAAZ,GAAoB,OAAxB,CAAiC,CAC/B,MAAOP,CAAAA,QAAP,CACD,CACD,GAAIO,YAAY,CAACW,MAAb,CAAsB,CAA1B,CAA6B,CAC3B,MAAOZ,CAAAA,cAAc,CAACC,YAAD,CAAeC,aAAf,CAA8BR,QAA9B,CAArB,CACD,CACD,MAAOA,CAAAA,QAAP,CACD,CATM","sourcesContent":["import { useContext } from 'react'\nimport { TranslationsContext } from '../contexts/Localisation/translationsContext'\n\nconst variableRegex = /%(.*?)%/\n\nconst replaceDynamicString = (foundTranslation: string, fallback: string) => {\n  const stringToReplace = variableRegex.exec(foundTranslation)[0]\n  // const indexToReplace = foundTranslation.split(' ').indexOf(stringToReplace)\n  const fallbackValueAtIndex = fallback.split(' ')[0]\n  return foundTranslation.replace(stringToReplace, fallbackValueAtIndex)\n}\n\nexport const getTranslation = (translations: Array<any>, translationId: number, fallback: string) => {\n  const foundTranslation = translations.find((translation) => {\n    return translation.data.stringId === translationId\n  })\n  if (foundTranslation) {\n    const translatedString = foundTranslation.data.text\n    const includesVariable = translatedString.includes('%')\n    if (includesVariable) {\n      return replaceDynamicString(translatedString, fallback)\n    }\n    return translatedString\n  }\n  return fallback\n}\n\n// TODO: Replace instances where this is called directly with the \"useI18n\" hook.\n// Using this directly can lead to errors because \"useContext\" is not preserved between renders\n// @see https://reactjs.org/docs/hooks-rules.html\nexport const TranslateString = (translationId: number, fallback: string) => {\n  const { translations } = useContext(TranslationsContext)\n  if (translations[0] === 'error') {\n    return fallback\n  }\n  if (translations.length > 0) {\n    return getTranslation(translations, translationId, fallback)\n  }\n  return fallback\n}\n"]},"metadata":{},"sourceType":"module"}